{"map":"{\"version\":3,\"sources\":[\"cognito.js\"],\"names\":[\"e\",\"a\",\"i\",\"exports\",\"modules\",\"installedModules\",\"__webpack_require__\",\"moduleId\",\"module\",\"l\",\"call\",\"m\",\"c\",\"d\",\"name\",\"getter\",\"o\",\"Object\",\"defineProperty\",\"enumerable\",\"get\",\"r\",\"Symbol\",\"toStringTag\",\"value\",\"t\",\"mode\",\"__esModule\",\"ns\",\"create\",\"key\",\"bind\",\"n\",\"object\",\"property\",\"prototype\",\"hasOwnProperty\",\"p\",\"s\",\"11\",\"__webpack_exports__\",\"GlobalSettingsService\",\"[object Object]\",\"globalRepo\",\"this\",\"getGlobalSettings\",\"transcribe\",\"encrypt\",\"deliveryEmail\",\"availableSMSCountries\",\"updateGlobalSettings\",\"then\",\"result\",\"console\",\"log\",\"JSON\",\"stringify\",\"transcribeVoicemail\",\"encryptVoicemail\",\"Attributes\",\"createGlobalSettings\",\"process\",\"env\",\"DELIVERY_EMAIL\",\"1210\",\"CloudFormationResponse\",\"sendCloudFormationResponse\",\"event\",\"context\",\"responseStatus\",\"physicalResourceId\",\"responseData\",\"noEcho\",\"Promise\",\"resolve\",\"reject\",\"reason\",\"logStreamName\",\"responseBody\",\"Status\",\"Reason\",\"PhysicalResourceId\",\"StackId\",\"RequestId\",\"LogicalResourceId\",\"NoEcho\",\"Data\",\"https\",\"parsedUrl\",\"parse\",\"ResponseURL\",\"options\",\"hostname\",\"port\",\"path\",\"method\",\"headers\",\"content-type\",\"content-length\",\"length\",\"request\",\"response\",\"statusCode\",\"statusMessage\",\"on\",\"error\",\"write\",\"end\",\"external_amazon_cognito_identity_js_\",\"Error\",\"AWS\",\"global\",\"fetch\",\"default\",\"global_repo\",\"globalSettings\",\"cognitoService\",\"identityServiceProvider\",\"CognitoIdentityServiceProvider\",\"userPoolId\",\"COGNITO_USER_POOL_ID\",\"email\",\"firstName\",\"lastName\",\"roles\",\"removeExisting\",\"temporaryPassword\",\"params\",\"UserPoolId\",\"Username\",\"DesiredDeliveryMediums\",\"ForceAliasCreation\",\"UserAttributes\",\"Name\",\"Value\",\"getCognitoUser\",\"actions\",\"adminDeleteUser\",\"adminCreateUser\",\"promise\",\"all\",\"split\",\"map\",\"role\",\"adminAddUserToGroup\",\"GroupName\",\"idToken\",\"accessToken\",\"refreshToken\",\"AccessToken\",\"IdToken\",\"RefreshToken\",\"cachedSession\",\"isValid\",\"Pool\",\"poolData\",\"refreshSession\",\"err\",\"session\",\"getIdToken\",\"getJwtToken\",\"getAccessToken\",\"getRefreshToken\",\"getToken\",\"username\",\"adminGetUser\",\"data\",\"usersConfig\",\"ResourceProperties\",\"RequestType\",\"AdminEmail\",\"AdminFirstName\",\"AdminLastName\",\"ManagerEmail\",\"ManagerFirstName\",\"ManagerLastName\",\"undefined\",\"catch\",\"createDefault\",\"14\",\"global_repo_GlobalRepo\",\"dynamo\",\"GlobalSettings\",\"globalSettingsMap\",\"AVAILABLE_SMS_COUNTRIES\",\"GLOBAL_TABLE_NAME\",\"amazonConnectInstanceArn\",\"AMAZON_CONNECT_INSTANCE_ARN\",\"Key\",\"instanceArn\",\"getItem\",\"item\",\"settings\",\"Item\",\"put\",\"_updateGlobalSettings\",\"ExpressionAttributeValues\",\":tv\",\":ev\",\":de\",\":ac\",\"UpdateExpression\",\"update\",\"15\",\"require\",\"18\",\"3\",\"4\",\"DynamoDBService\",\"tableName\",\"client\",\"DynamoDB\",\"DocumentClient\",\"query\",\"Items\",\"items\",\"scan\",\"allItems\",\"concat\",\"LastEvaluatedKey\",\"ExclusiveStartKey\",\"next\",\"Buffer\",\"from\",\"toString\",\"callback\",\"batch\",\"startingIndex\",\"_batchWrite\",\"index\",\"batchWrite\",\"nextData\",\"endIndex\",\"batchToUpdate\",\"slice\",\"batchParam\",\"RequestItems\",\"73\",\"8\"],\"mappings\":\"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\"}","code":"!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=1210)}({11:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return r}));class r{constructor(e){this.globalRepo=e}getSettings(){return this.globalRepo.getGlobalSettings()}update(e,t,n,r){return this.globalRepo.updateGlobalSettings(e,t,n,r).then(e=>{console.log(\"Result: \"+JSON.stringify(e));let{transcribeVoicemail:t,encryptVoicemail:n,deliveryEmail:r,availableSMSCountries:i}=e.Attributes;return{transcribeVoicemail:t,encryptVoicemail:n,deliveryEmail:r,availableSMSCountries:i}})}createDefault(){return this.globalRepo.createGlobalSettings(!0,!0,process.env.DELIVERY_EMAIL)}}},1210:function(e,t,n){\"use strict\";n.r(t);const r=\"SUCCESS\",i=\"FAILED\";function s(e,t,r,i,s={},o=!1){return new Promise((a,l)=>{let c=\"\";\"FAILED\"===r&&(c=\"See details in CloudWatch Stream \"+t.logStreamName);let u=JSON.stringify({Status:r,Reason:c,PhysicalResourceId:i||t.logStreamName,StackId:e.StackId,RequestId:e.RequestId,LogicalResourceId:e.LogicalResourceId,NoEcho:o,Data:s}),m=n(8),d=n(15).parse(e.ResponseURL),h={hostname:d.hostname,port:443,path:d.path,method:\"PUT\",headers:{\"content-type\":\"\",\"content-length\":u.length}},g=m.request(h,e=>{a({statusCode:e.statusCode,statusMessage:e.statusMessage})});g.on(\"error\",e=>{console.log(JSON.stringify(e,null,2)),l(\"send(..) failed executing https.request(..): \"+e)}),g.write(u),g.end()})}var o=n(18);Error;const a=n(3);global.fetch=n(73).default;var l=n(14);const c=new(n(11).a)(new l.a),u=new class{constructor(){this.identityServiceProvider=new a.CognitoIdentityServiceProvider,this.userPoolId=process.env.COGNITO_USER_POOL_ID}adminCreateUser(e,t,n,r,i=!1,s=null){let o={UserPoolId:this.userPoolId,Username:e,DesiredDeliveryMediums:[\"EMAIL\"],ForceAliasCreation:!1,UserAttributes:[{Name:\"given_name\",Value:t},{Name:\"family_name\",Value:n},{Name:\"email\",Value:e},{Name:\"email_verified\",Value:\"true\"}]};return s&&(o.TemporaryPassword=s),this.getCognitoUser(e).then(t=>{let n;return n=t&&i?this.adminDeleteUser(e).then(()=>this.identityServiceProvider.adminCreateUser(o).promise()):this.identityServiceProvider.adminCreateUser(o).promise(),n.then(()=>Promise.all(r.split(\",\").map(t=>this.identityServiceProvider.adminAddUserToGroup({GroupName:t,UserPoolId:this.userPoolId,Username:e}).promise())))})}adminDeleteUser(e){let t={UserPoolId:this.userPoolId,Username:e};return this.identityServiceProvider.adminDeleteUser(t).promise()}refreshToken(e,t,n,r){return new Promise((i,s)=>{const a=new o.CognitoAccessToken({AccessToken:n}),l=new o.CognitoIdToken({IdToken:t}),c=new o.CognitoRefreshToken({RefreshToken:r}),u=new o.CognitoUserSession({IdToken:l,RefreshToken:c,AccessToken:a});if(console.log(\"Refreshing token\",u.isValid()),u.isValid()){new o.CognitoUser({Username:e,Pool:new o.CognitoUserPool(this.poolData)}).refreshSession(c,(e,t)=>{e?s(e):i({idToken:t.getIdToken().getJwtToken(),accessToken:t.getAccessToken().getJwtToken(),refreshToken:t.getRefreshToken().getToken()})})}else s(new Error(\"InvalidUserSession\"))})}getCognitoUser(e){return new Promise((t,n)=>{let r={UserPoolId:this.userPoolId,Username:e};this.identityServiceProvider.adminGetUser(r,(e,n)=>{e&&(console.log(JSON.stringify(e,null,2)),t(null)),t(n)})})}};exports.usersConfig=(e,t)=>{let{ResourceProperties:n,RequestType:o}=e,{AdminEmail:a,AdminFirstName:l,AdminLastName:m,ManagerEmail:d,ManagerFirstName:h,ManagerLastName:g}=n;return\"Create\"!==o&&\"Update\"!==o||void 0===a||void 0===d?s(e,t,r,t.logStreamName).then(e=>console.log(\"Success sending cloudformation result\")).catch(e=>console.log(\"Error sending cloudformation result\")):u.adminCreateUser(a,l,m,\"Admin,Manager\",!0).then(()=>u.adminCreateUser(d,h,g,\"Manager\",!0)).then(()=>s(e,t,r,t.logStreamName)).then(e=>console.log(\"Successful send.\")).then(()=>c.createDefault()).then(e=>console.log(\"Successful put!\")).catch(n=>(console.log(JSON.stringify(n,null,2)),s(e,t,i,t.logStreamName)))}},14:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return s}));var r=n(4);class i{constructor(e){this.transcribeVoicemail=e.transcribeVoicemail||!1,this.encryptVoicemail=e.encryptVoicemail||!1,this.deliveryEmail=e.deliveryEmail||null,this.availableSMSCountries=e.availableSMSCountries||(process.env.AVAILABLE_SMS_COUNTRIES||\"\").split(\",\")}}class s{constructor(){this.dynamo=new r.a(process.env.GLOBAL_TABLE_NAME),this.amazonConnectInstanceArn=process.env.AMAZON_CONNECT_INSTANCE_ARN}getGlobalSettings(){console.log(\"Getting Global Settings\");let e={Key:{instanceArn:this.amazonConnectInstanceArn}};return this.dynamo.getItem(e).then(e=>e?new i(e):null)}createGlobalSettings(e,t,n,r){let s=new i({transcribeVoicemail:e,encryptVoicemail:t,deliveryEmail:n,availableSMSCountries:r});s.instanceArn=this.amazonConnectInstanceArn;let o={Item:s};return console.log(\"dynamo put\"),this.dynamo.put(o).then(()=>s)}updateGlobalSettings(e,t,n,r){return this.getGlobalSettings().then(i=>i?this._updateGlobalSettings(e,t,n,r):(console.log(\"in create\"),this.createGlobalSettings(e,t,n,r)))}_updateGlobalSettings(e,t,n,r){let i={Key:{instanceArn:this.amazonConnectInstanceArn},ExpressionAttributeValues:{\":tv\":e,\":ev\":t,\":de\":n,\":ac\":r},UpdateExpression:\"SET transcribeVoicemail=:tv, encryptVoicemail=:ev, deliveryEmail=:de, availableSMSCountries=:ac\"};return this.dynamo.update(i)}}},15:function(e,t){e.exports=require(\"url\")},18:function(e,t){e.exports=require(\"amazon-cognito-identity-js\")},3:function(e,t){e.exports=require(\"aws-sdk\")},4:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return i}));const r=n(3);class i{constructor(e){this.tableName=e,this.client=new r.DynamoDB.DocumentClient}update(e){return e.TableName=this.tableName,e.ReturnValues=\"ALL_NEW\",this.client.update(e).promise()}put(e){return e.TableName=this.tableName,this.client.put(e).promise()}query(e){return e.TableName=this.tableName,this.client.query(e).promise().then(e=>e.Items||null)}scan(e,t=[]){return e.TableName=this.tableName,this.client.scan(e).promise().then(n=>{let r=t;return n.Items&&(r=t.concat(n.Items)),n.LastEvaluatedKey?(console.log(\"Rescanning with next page\"),e.ExclusiveStartKey=n.LastEvaluatedKey,this.scan(e,r)):r})}queryWithNext(e){return e.TableName=this.tableName,this.client.query(e).promise().then(e=>{let t={data:e.Items||[]};return e.LastEvaluatedKey&&(t.next=Buffer.from(JSON.stringify(e.LastEvaluatedKey),\"utf8\").toString(\"base64\")),t})}scanWithNext(e){return e.TableName=this.tableName,this.client.scan(e).promise().then(e=>{let t={data:e.Items||[]};return e.LastEvaluatedKey&&(t.next=Buffer.from(JSON.stringify(e.LastEvaluatedKey),\"utf8\").toString(\"base64\")),t})}getItem(e,t){return e.TableName=this.tableName,this.client.get(e).promise().then(e=>e.Item||null)}batchWrite(e,t){return new Promise((n,r)=>{this._batchWrite(e,t).then(t=>{e.length>t.index?this.batchWrite(e,t.index).then(e=>{n(e)}):n(t.data)})})}_batchWrite(e,t){return new Promise((n,r)=>{let i=e.length>t+24?t+24:e.length,s=e.slice(t,i),o={RequestItems:{[this.tableName]:s}};this.client.batchWrite(o,(e,r)=>{e&&console.log(\"Any error? \"+JSON.stringify(e,null,2)),n({index:t+24,data:r})})})}}},73:function(e,t){e.exports=require(\"node-fetch\")},8:function(e,t){e.exports=require(\"https\")}}));","extractedComments":[]}